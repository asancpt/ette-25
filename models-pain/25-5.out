2018-03-13 
¿ÀÀü 09:32
;APPENDIX 25.5 NONMEM CONTROL FILE TO ESTIMATE
;PAIN AND REMEDICATION MODEL PARAMETERS
$PROB Analgesic Pain Model for nonrandomly censored data
$INPUT ISIM ID=L1 TIME MDV PRLF=DV QUIT PTIM DOSE CL VC Q VP KA ALAG FBIO
; ISIM ID TIME MDV AMT PRLF QUIT PTIM DOSE
; ID = subject ID number
; TIME = time of dose or observation
; MDV = event ID (0=obs, 1=dose)
; AMT = dose amount (MDV=1) or "." (MDV=0)
; PRLF = Ordinal pain relief score (0=no relief thru 4=full relief)
; TQT = Time to remedication
; QUIT = Indicator of remedication (0=stay in study; 1=quit study)
; PTIM = Time of previous pain observation
; DOSE = nominal dose amount
$DATA ../data/analgesicSim.csv IGNORE=#
$THETA
; Pain Model Parameters
0.4 ; KE0 [1/h]
-2 ; BT1
-2 ; BT2
-2 ; BT3
-2 ; BT4
100 ; EC50 [ng/mL]
20 ; EMAX
0 FIX ; ALPH
2 ; GAMM
5 ; AA
;
; Remedication Model Parameters
0.2 ; LAM0
0.002 ; LAM1
0.002 ; LAM2
0.001 FIX ; LAM3
0.0001 FIX ; LAM4
$OMEGA
; Pain and Remedication Model Parameters
1 ; Pain
0.0 FIX ; Remedication
$ABBREVIATED DERIV2=NOCOMMON
$PRED
; Specify Pain Model Parameters
KE0 = THETA(1)
BT1 = THETA(2)
BT2 = THETA(3)
BT3 = THETA(4)
BT4 = THETA(5)
EC50 = THETA(6)
EMAX = THETA(7)
ALPH = THETA(8)
GAMM = THETA(9)
AA = THETA(10)
ZPAN = ETA(1)
;
; Specify Remedication Model Parameters
LAM0 = THETA(11)
LAM1 = THETA(12)
LAM2 = THETA(13)
LAM3 = THETA(14)
LAM4 = THETA(15)
ZRMD = ETA(2)
; Calculate concentration in effect compartment
K20 = CL/VC
K23 = Q/VC
K32 = Q/VP
BET1 = K23+K32+K20
BET2 = SQRT(BET1**2 - 4*K32*K20)
BETA = 0.5*(BET1 - BET2)
ALFA = K32*K20/BETA
BSL = KE0*KA*DOSE*FBIO/VC
M1 = ALFA - KA
M2 = -M1
Q1 = BETA - KA
Q2 = -Q1
R1 = KE0 - KA
R2 = -R1
S1 = BETA - ALFA
S2 = -S1
T1 = KE0 - ALFA
T2 = -T1
U1 = KE0 - BETA
U2 = -U1
Z1 = K32 - KA
Z2 = K32 - ALFA
Z3 = K32 - BETA
Z4 = K32 - KE0
TIM2 = TIME-ALAG
E1 = EXP(-KA*TIM2)
E2 = EXP(-ALFA*TIM2)
E3 = EXP(-BETA*TIM2)
E4 = EXP(-KE0*TIM2)
CE1 = Z1*E1/(M1*Q1*R1)
CE2 = Z2*E2/(M2*S1*T1)
CE3 = Z3*E3/(Q2*S2*U1)
CE4 = Z4*E4/(R2*T2*U2)
IF (TIME .LE. ALAG) THEN
CE = 0.0
ELSE
CE = BSL*(CE1 + CE2 + CE3 + CE4)
ENDIF
; Specify placebo effect for each cumulative probability
PEFF = EXP(-ALPH*TIME) - EXP(-GAMM*TIME)
PEFF1 = BT1 + AA*PEFF
PEFF2 = PEFF1 + BT2
PEFF3 = PEFF2 + BT3
PEFF4 = PEFF3 + BT4
; Specify drug effect
DEFF = EMAX * CE/(EC50 + CE)
; Logits for cummulative probabilities
LGT1 = PEFF1 + DEFF + ETA(1)
LGT2 = PEFF2 + DEFF + ETA(1)
LGT3 = PEFF3 + DEFF + ETA(1)
LGT4 = PEFF4 + DEFF + ETA(1)
; Exponentiate logit
C1 = EXP(LGT1)
C2 = EXP(LGT2)
C3 = EXP(LGT3)
C4 = EXP(LGT4)
; Calculate cumulative probability of response j
P1 = C1/(1+C1) ; P(Y<=1|X)
P2 = C2/(1+C2) ; P(Y<=2|X)
P3 = C3/(1+C3) ; P(Y<=3|X)
P4 = C4/(1+C4) ; P(Y==4|X)
; Likelihood (Yj), by pain relief (j = 0 to 4)
Y0 = 1 - P1
Y1 = P1 - P2
Y2 = P2 - P3
Y3 = P3 - P4
Y4 = P4
IND0=0
IND1=0
IND2=0
IND3=0
IND4=0
IF (PRLF .EQ. 0) IND0=1
IF (PRLF .EQ. 1) IND1=1
IF (PRLF .EQ. 2) IND2=1
IF (PRLF .EQ. 3) IND3=1
IF (PRLF .EQ. 4) IND4=1
; Calculate likelihood of pain score
YP = Y0*IND0 + Y1*IND1 + Y2*IND2 + Y3*IND3 + Y4*IND4
; Calculate likelihood of remedication
LAMM = LAM0
IF(PRLF .EQ. 1) LAMM = LAM1
IF(PRLF .EQ. 2) LAMM = LAM2
IF(PRLF .EQ. 3) LAMM = LAM3
IF(PRLF .EQ. 4) LAMM = LAM4
LAMM = LAMM + ETA(2)
; Prob that subject has not remedicated upto time=TIME
YR0 = EXP(-LAMM*TIME)
;
; Prob that subject will remedicate at time=TIME, and that subject has
; not remedicated at time=PTIM
ETIM = TIME - PTIM
IF(MDV .EQ. 0) THEN
YR10 = 1 - EXP(-LAMM*ETIM)
ELSE
YR10 = 1
ENDIF
YR11 = EXP(-LAMM*PTIM)
YR1 = YR10*YR11
;
; Prob for remedication model
YR = YR0*(1-QUIT) + YR1*QUIT
; Overall likelihood
IF (MDV .EQ. 0) THEN
Y = YP*YR
ELSE
Y = 0
ENDIF
$ESTIMATION SIG=3 MAX=9999 PRINT=1 METHOD=COND LAPLACE LIKE NOABORT
$COV PRINT=ER
$TABLE NOPRINT ONEHEADER FILE=analgesicEst3.tab
ISIM ID TIME PTIM MDV DOSE QUIT
P1 P2 P3 P4 Y0 Y1 Y2 Y3 Y4 YR0 YR1 YP YR Y

  
NM-TRAN MESSAGES 
  
 WARNINGS AND ERRORS (IF ANY) FOR PROBLEM    1
             
 (WARNING  2) NM-TRAN INFERS THAT THE DATA ARE POPULATION.
  
License Registered to: Asan Medical Center
Expiration Date:    14 DEC 2018
Current Date:       13 MAR 2018
Days until program expires : 271
1NONLINEAR MIXED EFFECTS MODEL PROGRAM (NONMEM) VERSION 7.4.1
 ORIGINALLY DEVELOPED BY STUART BEAL, LEWIS SHEINER, AND ALISON BOECKMANN
 CURRENT DEVELOPERS ARE ROBERT BAUER, ICON DEVELOPMENT SOLUTIONS,
 AND ALISON BOECKMANN. IMPLEMENTATION, EFFICIENCY, AND STANDARDIZATION
 PERFORMED BY NOUS INFOSYSTEMS.

 PROBLEM NO.:         1
 Analgesic Pain Model for nonrandomly censored data
0DATA CHECKOUT RUN:              NO
 DATA SET LOCATED ON UNIT NO.:    2
 THIS UNIT TO BE REWOUND:        NO
 NO. OF DATA RECS IN DATA SET:     3687
 NO. OF DATA ITEMS IN DATA SET:  15
 ID DATA ITEM IS DATA ITEM NO.:   2
 DEP VARIABLE IS DATA ITEM NO.:   5
 MDV DATA ITEM IS DATA ITEM NO.:  4
0LABELS FOR DATA ITEMS:
 ISIM ID TIME MDV PRLF QUIT PTIM DOSE CL VC Q VP KA ALAG FBIO
0(NONBLANK) LABELS FOR PRED-DEFINED ITEMS:
 P1 P2 P3 P4 Y0 Y1 Y2 Y3 Y4 YP YR0 YR1 YR Y
0FORMAT FOR DATA:
 (E2.0,E4.0,E5.0,3E2.0,2E5.0,E8.0,E7.0,E2.0,E3.0,E8.0,E10.0,E9.0)

 TOT. NO. OF OBS RECS:     3087
 TOT. NO. OF INDIVIDUALS:      600
0LENGTH OF THETA:  15
0DEFAULT THETA BOUNDARY TEST OMITTED:    NO
0OMEGA HAS BLOCK FORM:
  1
  0  2
0DEFAULT OMEGA BOUNDARY TEST OMITTED:    NO
0INITIAL ESTIMATE OF THETA:
 LOWER BOUND    INITIAL EST    UPPER BOUND
 -0.1000E+07     0.4000E+00     0.1000E+07
 -0.1000E+07    -0.2000E+01     0.1000E+07
 -0.1000E+07    -0.2000E+01     0.1000E+07
 -0.1000E+07    -0.2000E+01     0.1000E+07
 -0.1000E+07    -0.2000E+01     0.1000E+07
 -0.1000E+07     0.1000E+03     0.1000E+07
 -0.1000E+07     0.2000E+02     0.1000E+07
  0.0000E+00     0.0000E+00     0.0000E+00
 -0.1000E+07     0.2000E+01     0.1000E+07
 -0.1000E+07     0.5000E+01     0.1000E+07
 -0.1000E+07     0.2000E+00     0.1000E+07
 -0.1000E+07     0.2000E-02     0.1000E+07
 -0.1000E+07     0.2000E-02     0.1000E+07
  0.1000E-02     0.1000E-02     0.1000E-02
  0.1000E-03     0.1000E-03     0.1000E-03
0INITIAL ESTIMATE OF OMEGA:
 BLOCK SET NO.   BLOCK                                                                    FIXED
        1                                                                                   NO
                  0.1000E+01
        2                                                                                  YES
                  0.0000E+00
0COVARIANCE STEP OMITTED:        NO
 R MATRIX PRINTED:              YES
 S MATRIX PRINTED:               NO
 EIGENVLS. PRINTED:             YES
 SPECIAL COMPUTATION:            NO
 COMPRESSED FORMAT:              NO
 GRADIENT METHOD USED:     NOSLOW
 SIGDIGITS ETAHAT (SIGLO):                  -1
 SIGDIGITS GRADIENTS (SIGL):                -1
 EXCLUDE COV FOR FOCE (NOFCOV):              NO
 TURN OFF Cholesky Transposition of R Matrix (CHOLROFF): NO
 KNUTHSUMOFF:                                -1
 RESUME COV ANALYSIS (RESUME):               NO
 SIR SAMPLE SIZE (SIRSAMPLE):              -1
 NON-LINEARLY TRANSFORM THETAS DURING COV (THBND): 1
 PRECONDTIONING CYCLES (PRECOND):        0
 PRECONDTIONING TYPES (PRECONDS):        TOS
 FORCED PRECONDTIONING CYCLES (PFCOND):0
 PRECONDTIONING TYPE (PRETYPE):        0
 FORCED POS. DEFINITE SETTING: (FPOSDEF):0
0TABLES STEP OMITTED:    NO
 NO. OF TABLES:           1
 SEED NUMBER (SEED):    11456
 RANMETHOD:             3U
 MC SAMPLES (ESAMPLE):    300
 WRES SQUARE ROOT TYPE (WRESCHOL): EIGENVALUE
0-- TABLE   1 --
0RECORDS ONLY:    ALL
04 COLUMNS APPENDED:    YES
 PRINTED:                NO
 HEADERS:               ONE
 FILE TO BE FORWARDED:   NO
 FORMAT:                S1PE11.4
 LFORMAT:
 RFORMAT:
 FIXED_EFFECT_ETAS:
0USER-CHOSEN ITEMS:
 ISIM ID TIME PTIM MDV DOSE QUIT P1 P2 P3 P4 Y0 Y1 Y2 Y3 Y4 YR0 YR1 YP YR Y
1


 #TBLN:      1
 #METH: Laplacian Conditional Estimation

 ESTIMATION STEP OMITTED:                 NO
 ANALYSIS TYPE:                           POPULATION
 NUMBER OF SADDLE POINT RESET ITERATIONS:      0
 GRADIENT METHOD USED:               NOSLOW
 CONDITIONAL ESTIMATES USED:              YES
 CENTERED ETA:                            NO
 EPS-ETA INTERACTION:                     NO
 LAPLACIAN OBJ. FUNC.:                    YES
 NUMERICAL 2ND DERIVATIVES:               NO
 PRED F SET TO A LIKELIHOOD:              YES
 NO. OF FUNCT. EVALS. ALLOWED:            9999
 NO. OF SIG. FIGURES REQUIRED:            3
 INTERMEDIATE PRINTOUT:                   YES
 ESTIMATE OUTPUT TO MSF:                  NO
 ABORT WITH PRED EXIT CODE 1:             NO
 IND. OBJ. FUNC. VALUES SORTED:           NO
 NUMERICAL DERIVATIVE
       FILE REQUEST (NUMDER):               NONE
 MAP (ETAHAT) ESTIMATION METHOD (OPTMAP):   0
 ETA HESSIAN EVALUATION METHOD (ETADER):    0
 INITIAL ETA FOR MAP ESTIMATION (MCETA):    0
 SIGDIGITS FOR MAP ESTIMATION (SIGLO):      100
 GRADIENT SIGDIGITS OF
       FIXED EFFECTS PARAMETERS (SIGL):     100
 NOPRIOR SETTING (NOPRIOR):                 OFF
 NOCOV SETTING (NOCOV):                     OFF
 DERCONT SETTING (DERCONT):                 OFF
 FINAL ETA RE-EVALUATION (FNLETA):          ON
 EXCLUDE NON-INFLUENTIAL (NON-INFL.) ETAS
       IN SHRINKAGE (ETASTYPE):             NO
 NON-INFL. ETA CORRECTION (NONINFETA):      OFF
 RAW OUTPUT FILE (FILE): 25-5.ext
 EXCLUDE TITLE (NOTITLE):                   NO
 EXCLUDE COLUMN LABELS (NOLABEL):           NO
 FORMAT FOR ADDITIONAL FILES (FORMAT):      S1PE12.5
 PARAMETER ORDER FOR OUTPUTS (ORDER):       TSOL
 WISHART PRIOR DF INTERPRETATION (WISHTYPE):0
 KNUTHSUMOFF:                               0
 INCLUDE LNTWOPI:                           NO
 INCLUDE CONSTANT TERM TO PRIOR (PRIORC):   NO
 INCLUDE CONSTANT TERM TO OMEGA (ETA) (OLNTWOPI):NO
 ADDITIONAL CONVERGENCE TEST (CTYPE=4)?:    NO
 EM OR BAYESIAN METHOD USED:                 NONE


 THE FOLLOWING LABELS ARE EQUIVALENT
 PRED=NPRED
 RES=NRES
 WRES=NWRES
 IWRS=NIWRES
 IPRD=NIPRED
 IRS=NIRES

 MONITORING OF SEARCH:


0ITERATION NO.:    0    OBJECTIVE VALUE:   9238.90604249382        NO. OF FUNC. EVALS.:  15
 CUMULATIVE NO. OF FUNC. EVALS.:       15
 NPARAMETR:  4.0000E-01 -2.0000E+00 -2.0000E+00 -2.0000E+00 -2.0000E+00  1.0000E+02  2.0000E+01  2.0000E+00  5.0000E+00  2.0000E-01
             2.0000E-03  2.0000E-03  1.0000E+00
 PARAMETER:  1.0000E-01 -1.0000E-01 -1.0000E-01 -1.0000E-01 -1.0000E-01  1.0000E-01  1.0000E-01  1.0000E-01  1.0000E-01  1.0000E-01
             1.0000E-01  1.0000E-01  1.0000E-01
 GRADIENT:   9.1600E+03  2.7275E+04  1.1354E+04  5.8093E+02 -2.6201E+03 -1.0803E+04  1.2967E+04  1.7809E+04  5.3358E+04  7.4305E+02
             9.6600E+00 -2.9650E+00 -1.6104E+03

0ITERATION NO.:    1    OBJECTIVE VALUE:   7878.29861073619        NO. OF FUNC. EVALS.:  18
 CUMULATIVE NO. OF FUNC. EVALS.:       33
 NPARAMETR:  3.7716E-01 -2.3401E+00 -2.1416E+00 -2.0072E+00 -1.9673E+00  1.0674E+02  1.8383E+01  1.7779E+00  3.3366E+00  1.9907E-01
             1.9999E-03  2.0000E-03  1.0020E+00
 PARAMETER:  9.4289E-02 -1.1701E-01 -1.0708E-01 -1.0036E-01 -9.8366E-02  1.0674E-01  9.1916E-02  8.8896E-02  6.6732E-02  9.9537E-02
             9.9994E-02  1.0000E-01  1.0100E-01
 GRADIENT:  -4.4251E+03  3.4083E+03 -4.1211E+03 -7.3340E+03 -6.6468E+03  5.2314E+03 -7.7763E+03  3.0958E+03  2.0491E+03  7.2929E+02
             9.6588E+00 -2.9646E+00 -1.0688E+02
 CONDITIONAL LIKELIHOOD SET TO NEGATIVE VALUE
 WITH INDIVIDUAL       4 (IN INDIVIDUAL RECORD ORDERING), DATA RECORD   1

 #TERM:
  
 TOTAL DATA POINTS NORMALLY DISTRIBUTED (N):            0
 N*LOG(2PI) CONSTANT TO OBJECTIVE FUNCTION:    0.0000000000000000     
 OBJECTIVE FUNCTION VALUE WITHOUT CONSTANT:    7878.2986107361912     
 OBJECTIVE FUNCTION VALUE WITH CONSTANT:       7878.2986107361912     
 REPORTED OBJECTIVE FUNCTION DOES NOT CONTAIN CONSTANT
  
 TOTAL EFFECTIVE ETAS (NIND*NETA):                             3
  
 #TERE:
 Elapsed estimation  time in seconds:     1.51
 #CPUT: Total CPU Time in Seconds,        1.123
Stop Time: 
2018-03-13 
¿ÀÀü 09:32
