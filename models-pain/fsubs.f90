      MODULE NMPRD4P
      USE SIZES, ONLY: DPSIZE
      USE NMPRD4,ONLY: VRBL
      IMPLICIT NONE
      SAVE
      REAL(KIND=DPSIZE), DIMENSION (:),POINTER ::COM
      REAL(KIND=DPSIZE), POINTER ::KE0,BT1,BT2,BT3,BT4,EC50,EMAX,ALPH
      REAL(KIND=DPSIZE), POINTER ::GAMM,AA,ZPAN,LAM0,LAM1,LAM2,LAM3
      REAL(KIND=DPSIZE), POINTER ::LAM4,ZRMD,K20,K23,K32,BET1,BET2
      REAL(KIND=DPSIZE), POINTER ::BETA,ALFA,BSL,M1,M2,Q1,Q2,R1,R2,S1
      REAL(KIND=DPSIZE), POINTER ::S2,T1,T2,U1,U2,Z1,Z2,Z3,Z4,TIM2,E1
      REAL(KIND=DPSIZE), POINTER ::E2,E3,E4,CE1,CE2,CE3,CE4,CE,PEFF
      REAL(KIND=DPSIZE), POINTER ::PEFF1,PEFF2,PEFF3,PEFF4,DEFF,LGT1
      REAL(KIND=DPSIZE), POINTER ::LGT2,LGT3,LGT4,C1,C2,C3,C4,P1,P2,P3
      REAL(KIND=DPSIZE), POINTER ::P4,Y0,Y1,Y2,Y3,Y4,IND0,IND1,IND2
      REAL(KIND=DPSIZE), POINTER ::IND3,IND4,YP,LAMM,YR0,ETIM,YR10
      REAL(KIND=DPSIZE), POINTER ::YR11,YR1,YR,Y,A000059,A000075
      REAL(KIND=DPSIZE), POINTER ::A000091,A000107,A000121,A000124
      REAL(KIND=DPSIZE), POINTER ::A000129,A000134,A000144,A000176
      REAL(KIND=DPSIZE), POINTER ::A000189,A000209,A000210
      CONTAINS
      SUBROUTINE ASSOCNMPRD4
      COM=>VRBL
      KE0=>COM(000001);BT1=>COM(000002);BT2=>COM(000003)
      BT3=>COM(000004);BT4=>COM(000005);EC50=>COM(000006)
      EMAX=>COM(000007);ALPH=>COM(000008);GAMM=>COM(000009)
      AA=>COM(000010);ZPAN=>COM(000011);LAM0=>COM(000012)
      LAM1=>COM(000013);LAM2=>COM(000014);LAM3=>COM(000015)
      LAM4=>COM(000016);ZRMD=>COM(000017);K20=>COM(000018)
      K23=>COM(000019);K32=>COM(000020);BET1=>COM(000021)
      BET2=>COM(000022);BETA=>COM(000023);ALFA=>COM(000024)
      BSL=>COM(000025);M1=>COM(000026);M2=>COM(000027);Q1=>COM(000028)
      Q2=>COM(000029);R1=>COM(000030);R2=>COM(000031);S1=>COM(000032)
      S2=>COM(000033);T1=>COM(000034);T2=>COM(000035);U1=>COM(000036)
      U2=>COM(000037);Z1=>COM(000038);Z2=>COM(000039);Z3=>COM(000040)
      Z4=>COM(000041);TIM2=>COM(000042);E1=>COM(000043)
      E2=>COM(000044);E3=>COM(000045);E4=>COM(000046);CE1=>COM(000047)
      CE2=>COM(000048);CE3=>COM(000049);CE4=>COM(000050)
      CE=>COM(000051);PEFF=>COM(000052);PEFF1=>COM(000053)
      PEFF2=>COM(000054);PEFF3=>COM(000055);PEFF4=>COM(000056)
      DEFF=>COM(000057);LGT1=>COM(000058);LGT2=>COM(000059)
      LGT3=>COM(000060);LGT4=>COM(000061);C1=>COM(000062)
      C2=>COM(000063);C3=>COM(000064);C4=>COM(000065);P1=>COM(000066)
      P2=>COM(000067);P3=>COM(000068);P4=>COM(000069);Y0=>COM(000070)
      Y1=>COM(000071);Y2=>COM(000072);Y3=>COM(000073);Y4=>COM(000074)
      IND0=>COM(000075);IND1=>COM(000076);IND2=>COM(000077)
      IND3=>COM(000078);IND4=>COM(000079);YP=>COM(000080)
      LAMM=>COM(000081);YR0=>COM(000082);ETIM=>COM(000083)
      YR10=>COM(000084);YR11=>COM(000085);YR1=>COM(000086)
      YR=>COM(000087);Y=>COM(000088);A000059=>COM(000089)
      A000075=>COM(000090);A000091=>COM(000091);A000107=>COM(000092)
      A000121=>COM(000093);A000124=>COM(000094);A000129=>COM(000095)
      A000134=>COM(000096);A000144=>COM(000097);A000176=>COM(000098)
      A000189=>COM(000099);A000209=>COM(000100);A000210=>COM(000101)
      END SUBROUTINE ASSOCNMPRD4
      END MODULE NMPRD4P
      SUBROUTINE PRED (ICALL,NEWIND,THETA,DATREC,INDXS,F,G,H)                 
      USE NMPRD4P
      USE SIZES,     ONLY: DPSIZE,ISIZE
      USE PRDIMS,    ONLY: GPRD,HPRD,GERD,HERD,GPKD
      USE NMPRD_REAL,ONLY: ETA,EPS                                            
      USE NMPRD_INT, ONLY: MSEC=>ISECDER,MFIRST=>IFRSTDER,IFIRSTEM
      USE NMPRD_INT, ONLY: MDVRES,ETASXI,NPDE_MODE,NOFIRSTDERCODE
      USE NMPRD_REAL, ONLY: DV_LOQ,CDF_L
      USE NMBAYES_REAL, ONLY: LDF                                             
      IMPLICIT REAL(KIND=DPSIZE) (A-Z)                                        
      REAL(KIND=DPSIZE) :: DATREC                                             
      SAVE
      INTEGER(KIND=ISIZE) :: ICALL,NEWIND,INDXS                               
      REAL(KIND=DPSIZE) :: G(GPRD,*),H(HPRD,*)                                
      DIMENSION :: THETA(*),DATREC(*),INDXS(*)                                
      INTEGER(KIND=ISIZE) :: FIRSTEM
      FIRSTEM=IFIRSTEM
      IF (ICALL <= 1) CALL ASSOCNMPRD4
      IF (ICALL == 4) THEN
      IF (NEWIND /= 2) THEN
      CALL SIMETA(ETA)
      IF (IQUIT == 1) RETURN
      ENDIF
      ELSE
      IF (NEWIND /= 2) THEN
      CALL GETETA(ETA)
      IF (IQUIT == 1) RETURN
      ENDIF
      ENDIF
 !  level            0           0
      TIME=DATREC(003)
      MDV=DATREC(004)
      PRLF=DATREC(005)
      QUIT=DATREC(006)
      PTIM=DATREC(007)
      DOSE=DATREC(008)
      CL=DATREC(009)
      VC=DATREC(010)
      Q=DATREC(011)
      VP=DATREC(012)
      KA=DATREC(013)
      ALAG=DATREC(014)
      FBIO=DATREC(015)
      KE0=THETA(001) 
      BT1=THETA(002) 
      BT2=THETA(003) 
      BT3=THETA(004) 
      BT4=THETA(005) 
      EC50=THETA(006) 
      EMAX=THETA(007) 
      ALPH=THETA(008) 
      GAMM=THETA(009) 
      AA=THETA(010) 
      ZPAN=ETA(001) 
      LAM0=THETA(011) 
      LAM1=THETA(012) 
      LAM2=THETA(013) 
      LAM3=THETA(014) 
      LAM4=THETA(015) 
      ZRMD=ETA(002) 
      K20=CL/VC 
      K23=Q/VC 
      K32=Q/VP 
      BET1=K23+K32+K20 
      B000001=BET1**2 
      B000002=B000001-4.D0*K32*K20 
      B000003=DSQRT(B000002) 
      BET2=B000003 
      B000004=BET1-BET2 
      BETA=0.5D0*B000004 
      ALFA=K32*K20/BETA 
      BSL=KE0*KA*DOSE*FBIO/VC 
      M1=ALFA-KA 
      M2=-M1 
      Q1=BETA-KA 
      Q2=-Q1 
      R1=KE0-KA 
      R2=-R1 
      S1=BETA-ALFA 
      S2=-S1 
      T1=KE0-ALFA 
      T2=-T1 
      U1=KE0-BETA 
      U2=-U1 
      Z1=K32-KA 
      Z2=K32-ALFA 
      Z3=K32-BETA 
      Z4=K32-KE0 
      TIM2=TIME-ALAG 
      B000005=-KA*TIM2 
      B000006=DEXP(B000005) 
      E1=B000006 
      B000007=-ALFA*TIM2 
      B000008=DEXP(B000007) 
      E2=B000008 
      B000009=-BETA*TIM2 
      B000010=DEXP(B000009) 
      E3=B000010 
      B000011=-KE0*TIM2 
      B000012=DEXP(B000011) 
      E4=B000012 
      B000013=M1*Q1*R1 
      CE1=Z1*E1/B000013 
      B000014=M2*S1*T1 
      CE2=Z2*E2/B000014 
      B000015=Q2*S2*U1 
      CE3=Z3*E3/B000015 
      B000016=R2*T2*U2 
      CE4=Z4*E4/B000016 
      IF(TIME <= ALAG)THEN 
      CE=0.D0 
      ELSE 
      B000020=CE1+CE2+CE3+CE4 
      CE=BSL*B000020 
      ENDIF 
      B000022=-ALPH*TIME 
      B000023=-GAMM*TIME 
      B000024=DEXP(B000022) 
      B000025=DEXP(B000023) 
      PEFF=B000024-B000025 
      PEFF1=BT1+AA*PEFF 
      PEFF2=PEFF1+BT2 
      PEFF3=PEFF2+BT3 
      PEFF4=PEFF3+BT4 
      B000026=EC50+CE 
      DEFF=EMAX*CE/B000026 
      LGT1=PEFF1+DEFF+ETA(001) 
      LGT2=PEFF2+DEFF+ETA(001) 
      LGT3=PEFF3+DEFF+ETA(001) 
      LGT4=PEFF4+DEFF+ETA(001) 
      C1=DEXP(LGT1) 
      C2=DEXP(LGT2) 
      C3=DEXP(LGT3) 
      C4=DEXP(LGT4) 
      B000031=1.D0+C1 
      P1=C1/B000031 
      B000039=1.D0+C2 
      P2=C2/B000039 
      B000047=1.D0+C3 
      P3=C3/B000047 
      B000055=1.D0+C4 
      P4=C4/B000055 
      Y0=1.D0-P1 
      Y1=P1-P2 
      Y2=P2-P3 
      Y3=P3-P4 
      Y4=P4 
      IND0=0.D0 
      IND1=0.D0 
      IND2=0.D0 
      IND3=0.D0 
      IND4=0.D0 
      IF(PRLF == 0.D0)THEN 
      IND0=1.D0 
      ENDIF 
      IF(PRLF == 1.D0)THEN 
      IND1=1.D0 
      ENDIF 
      IF(PRLF == 2.D0)THEN 
      IND2=1.D0 
      ENDIF 
      IF(PRLF == 3.D0)THEN 
      IND3=1.D0 
      ENDIF 
      IF(PRLF == 4.D0)THEN 
      IND4=1.D0 
      ENDIF 
      YP=Y0*IND0+Y1*IND1+Y2*IND2+Y3*IND3+Y4*IND4 
      B000078=IND0 
      B000079=IND1 
      B000080=IND2 
      B000081=IND3 
      B000082=IND4 
      LAMM=LAM0 
      IF(PRLF == 1.D0)THEN 
      LAMM=LAM1 
      ENDIF 
      IF(PRLF == 2.D0)THEN 
      LAMM=LAM2 
      ENDIF 
      IF(PRLF == 3.D0)THEN 
      LAMM=LAM3 
      ENDIF 
      IF(PRLF == 4.D0)THEN 
      LAMM=LAM4 
      ENDIF 
      B000095=LAMM+ETA(002) 
      LAMM=B000095 
      B000096=-LAMM*TIME 
      B000097=DEXP(B000096) 
      YR0=B000097 
      ETIM=TIME-PTIM 
      Q000020=0.D0 
      Q000021=1.D0 
      IF(MDV == 0.D0)THEN 
      Q000020=1.D0 
      Q000021=0.D0 
      B000100=-LAMM*ETIM 
      B000101=DEXP(B000100) 
      B000102=1.D0-B000101 
      ELSE 
      ENDIF 
      B000105=Q000020*B000102+Q000021 
      YR10=B000105 
      B000106=-LAMM*PTIM 
      B000107=DEXP(B000106) 
      YR11=B000107 
      YR1=YR10*YR11 
      B000110=1.D0-QUIT 
      YR=YR0*B000110+YR1*QUIT 
      Q000022=0.D0 
      Q000023=1.D0 
      IF(MDV == 0.D0)THEN 
      Q000022=1.D0 
      Q000023=0.D0 
      B000113=YP*YR 
      ELSE 
      ENDIF 
      B000117=Q000022*B000113+Q000023*0.D0 
      Y=B000117 
      IF (FIRSTEM == 1) THEN !1
      B000032=1.D0/B000031 
!                      A000058 = DERIVATIVE OF P1 W.R.T. ETA(001)
      A000058=B000032*C1 
      B000033=-C1/B000031/B000031 
!                      A000059 = DERIVATIVE OF P1 W.R.T. ETA(001)
      A000059=B000033*C1+A000058 
      B000040=1.D0/B000039 
!                      A000074 = DERIVATIVE OF P2 W.R.T. ETA(001)
      A000074=B000040*C2 
      B000041=-C2/B000039/B000039 
!                      A000075 = DERIVATIVE OF P2 W.R.T. ETA(001)
      A000075=B000041*C2+A000074 
      B000048=1.D0/B000047 
!                      A000090 = DERIVATIVE OF P3 W.R.T. ETA(001)
      A000090=B000048*C3 
      B000049=-C3/B000047/B000047 
!                      A000091 = DERIVATIVE OF P3 W.R.T. ETA(001)
      A000091=B000049*C3+A000090 
      B000056=1.D0/B000055 
!                      A000106 = DERIVATIVE OF P4 W.R.T. ETA(001)
      A000106=B000056*C4 
      B000057=-C4/B000055/B000055 
!                      A000107 = DERIVATIVE OF P4 W.R.T. ETA(001)
      A000107=B000057*C4+A000106 
!                      A000121 = DERIVATIVE OF Y0 W.R.T. ETA(001)
      A000121=-A000059 
!                      A000124 = DERIVATIVE OF Y1 W.R.T. ETA(001)
      A000124=-A000075+A000059 
!                      A000129 = DERIVATIVE OF Y2 W.R.T. ETA(001)
      A000129=-A000091+A000075 
!                      A000134 = DERIVATIVE OF Y3 W.R.T. ETA(001)
      A000134=-A000107+A000091 
!                      A000140 = DERIVATIVE OF YP W.R.T. ETA(001)
      A000140=B000078*A000121 
!                      A000141 = DERIVATIVE OF YP W.R.T. ETA(001)
      A000141=B000079*A000124+A000140 
!                      A000142 = DERIVATIVE OF YP W.R.T. ETA(001)
      A000142=B000080*A000129+A000141 
!                      A000143 = DERIVATIVE OF YP W.R.T. ETA(001)
      A000143=B000081*A000134+A000142 
!                      A000144 = DERIVATIVE OF YP W.R.T. ETA(001)
      A000144=B000082*A000107+A000143 
!                      A000156 = DERIVATIVE OF B000096 W.R.T. ETA(002)
      A000156=-TIME 
!                      A000157 = DERIVATIVE OF B000097 W.R.T. ETA(002)
      A000157=B000097*A000156 
      IF(MDV == 0.D0)THEN 
!                      A000161 = DERIVATIVE OF B000100 W.R.T. ETA(002)
      A000161=-ETIM 
!                      A000162 = DERIVATIVE OF B000101 W.R.T. ETA(002)
      A000162=B000101*A000161 
!                      A000163 = DERIVATIVE OF B000102 W.R.T. ETA(002)
      A000163=-A000162 
      ELSE 
      ENDIF 
!                      A000166 = DERIVATIVE OF B000105 W.R.T. ETA(002)
      A000166=Q000020*A000163 
!                      A000170 = DERIVATIVE OF B000106 W.R.T. ETA(002)
      A000170=-PTIM 
!                      A000171 = DERIVATIVE OF B000107 W.R.T. ETA(002)
      A000171=B000107*A000170 
!                      A000175 = DERIVATIVE OF YR1 W.R.T. ETA(002)
      A000175=YR11*A000166 
!                      A000176 = DERIVATIVE OF YR1 W.R.T. ETA(002)
      A000176=YR10*A000171+A000175 
!                      A000188 = DERIVATIVE OF YR W.R.T. ETA(002)
      A000188=B000110*A000157 
!                      A000189 = DERIVATIVE OF YR W.R.T. ETA(002)
      A000189=QUIT*A000176+A000188 
      IF(MDV == 0.D0)THEN 
!                      A000193 = DERIVATIVE OF B000113 W.R.T. ETA(001)
      A000193=YR*A000144 
!                      A000194 = DERIVATIVE OF B000113 W.R.T. ETA(002)
      A000194=YP*A000189 
      ELSE 
      ENDIF 
!                      A000204 = DERIVATIVE OF B000117 W.R.T. ETA(002)
      A000204=Q000022*A000194 
!                      A000205 = DERIVATIVE OF B000117 W.R.T. ETA(001)
      A000205=Q000022*A000193 
!                      A000209 = DERIVATIVE OF Y W.R.T. ETA(001)
      A000209=A000205 
!                      A000210 = DERIVATIVE OF Y W.R.T. ETA(002)
      A000210=A000204 
      G(001,1)=A000209
      G(002,1)=A000210
      ENDIF !1
      IF (MSEC == 1) THEN
      B000035=-1.D0/B000031/B000031 
!                      A000062 = DERIVATIVE OF B000032 W.R.T. ETA(001)
      A000062=B000035*C1 
!                      A000063 = DERIVATIVE OF A000058 W.R.T. ETA(001)
      A000063=C1*A000062 
!                      A000064 = DERIVATIVE OF A000058 W.R.T. ETA(001)
      A000064=B000032*C1+A000063 
      B000036=-1.D0/B000031/B000031 
!                      A000065 = DERIVATIVE OF B000033 W.R.T. ETA(001)
      A000065=B000036*C1 
      B000037=C1/B000031/B000031/B000031 
!                      A000066 = DERIVATIVE OF B000033 W.R.T. ETA(001)
      A000066=B000037*C1+A000065 
      B000038=C1/B000031/B000031/B000031 
!                      A000067 = DERIVATIVE OF B000033 W.R.T. ETA(001)
      A000067=B000038*C1+A000066 
!                      A000068 = DERIVATIVE OF A000059 W.R.T. ETA(001)
      A000068=C1*A000067 
!                      A000069 = DERIVATIVE OF A000059 W.R.T. ETA(001)
      A000069=B000033*C1+A000068 
!                      A000070 = DERIVATIVE OF A000059 W.R.T. ETA(001)
      A000070=A000064+A000069 
      B000043=-1.D0/B000039/B000039 
!                      A000078 = DERIVATIVE OF B000040 W.R.T. ETA(001)
      A000078=B000043*C2 
!                      A000079 = DERIVATIVE OF A000074 W.R.T. ETA(001)
      A000079=C2*A000078 
!                      A000080 = DERIVATIVE OF A000074 W.R.T. ETA(001)
      A000080=B000040*C2+A000079 
      B000044=-1.D0/B000039/B000039 
!                      A000081 = DERIVATIVE OF B000041 W.R.T. ETA(001)
      A000081=B000044*C2 
      B000045=C2/B000039/B000039/B000039 
!                      A000082 = DERIVATIVE OF B000041 W.R.T. ETA(001)
      A000082=B000045*C2+A000081 
      B000046=C2/B000039/B000039/B000039 
!                      A000083 = DERIVATIVE OF B000041 W.R.T. ETA(001)
      A000083=B000046*C2+A000082 
!                      A000084 = DERIVATIVE OF A000075 W.R.T. ETA(001)
      A000084=C2*A000083 
!                      A000085 = DERIVATIVE OF A000075 W.R.T. ETA(001)
      A000085=B000041*C2+A000084 
!                      A000086 = DERIVATIVE OF A000075 W.R.T. ETA(001)
      A000086=A000080+A000085 
      B000051=-1.D0/B000047/B000047 
!                      A000094 = DERIVATIVE OF B000048 W.R.T. ETA(001)
      A000094=B000051*C3 
!                      A000095 = DERIVATIVE OF A000090 W.R.T. ETA(001)
      A000095=C3*A000094 
!                      A000096 = DERIVATIVE OF A000090 W.R.T. ETA(001)
      A000096=B000048*C3+A000095 
      B000052=-1.D0/B000047/B000047 
!                      A000097 = DERIVATIVE OF B000049 W.R.T. ETA(001)
      A000097=B000052*C3 
      B000053=C3/B000047/B000047/B000047 
!                      A000098 = DERIVATIVE OF B000049 W.R.T. ETA(001)
      A000098=B000053*C3+A000097 
      B000054=C3/B000047/B000047/B000047 
!                      A000099 = DERIVATIVE OF B000049 W.R.T. ETA(001)
      A000099=B000054*C3+A000098 
!                      A000100 = DERIVATIVE OF A000091 W.R.T. ETA(001)
      A000100=C3*A000099 
!                      A000101 = DERIVATIVE OF A000091 W.R.T. ETA(001)
      A000101=B000049*C3+A000100 
!                      A000102 = DERIVATIVE OF A000091 W.R.T. ETA(001)
      A000102=A000096+A000101 
      B000059=-1.D0/B000055/B000055 
!                      A000110 = DERIVATIVE OF B000056 W.R.T. ETA(001)
      A000110=B000059*C4 
!                      A000111 = DERIVATIVE OF A000106 W.R.T. ETA(001)
      A000111=C4*A000110 
!                      A000112 = DERIVATIVE OF A000106 W.R.T. ETA(001)
      A000112=B000056*C4+A000111 
      B000060=-1.D0/B000055/B000055 
!                      A000113 = DERIVATIVE OF B000057 W.R.T. ETA(001)
      A000113=B000060*C4 
      B000061=C4/B000055/B000055/B000055 
!                      A000114 = DERIVATIVE OF B000057 W.R.T. ETA(001)
      A000114=B000061*C4+A000113 
      B000062=C4/B000055/B000055/B000055 
!                      A000115 = DERIVATIVE OF B000057 W.R.T. ETA(001)
      A000115=B000062*C4+A000114 
!                      A000116 = DERIVATIVE OF A000107 W.R.T. ETA(001)
      A000116=C4*A000115 
!                      A000117 = DERIVATIVE OF A000107 W.R.T. ETA(001)
      A000117=B000057*C4+A000116 
!                      A000118 = DERIVATIVE OF A000107 W.R.T. ETA(001)
      A000118=A000112+A000117 
!                      A000122 = DERIVATIVE OF A000121 W.R.T. ETA(001)
      A000122=-A000070 
!                      A000126 = DERIVATIVE OF A000124 W.R.T. ETA(001)
      A000126=-A000086 
!                      A000127 = DERIVATIVE OF A000124 W.R.T. ETA(001)
      A000127=A000070+A000126 
!                      A000131 = DERIVATIVE OF A000129 W.R.T. ETA(001)
      A000131=-A000102 
!                      A000132 = DERIVATIVE OF A000129 W.R.T. ETA(001)
      A000132=A000086+A000131 
!                      A000136 = DERIVATIVE OF A000134 W.R.T. ETA(001)
      A000136=-A000118 
!                      A000137 = DERIVATIVE OF A000134 W.R.T. ETA(001)
      A000137=A000102+A000136 
!                      A000145 = DERIVATIVE OF A000140 W.R.T. ETA(001)
      A000145=B000078*A000122 
!                      A000146 = DERIVATIVE OF A000141 W.R.T. ETA(001)
      A000146=B000079*A000127 
!                      A000147 = DERIVATIVE OF A000141 W.R.T. ETA(001)
      A000147=A000145+A000146 
!                      A000148 = DERIVATIVE OF A000142 W.R.T. ETA(001)
      A000148=B000080*A000132 
!                      A000149 = DERIVATIVE OF A000142 W.R.T. ETA(001)
      A000149=A000147+A000148 
!                      A000150 = DERIVATIVE OF A000143 W.R.T. ETA(001)
      A000150=B000081*A000137 
!                      A000151 = DERIVATIVE OF A000143 W.R.T. ETA(001)
      A000151=A000149+A000150 
!                      A000152 = DERIVATIVE OF A000144 W.R.T. ETA(001)
      A000152=B000082*A000118 
!                      A000153 = DERIVATIVE OF A000144 W.R.T. ETA(001)
      A000153=A000151+A000152 
!                      A000159 = DERIVATIVE OF A000157 W.R.T. ETA(002)
      A000159=A000156*A000157 
      IF(MDV == 0.D0)THEN 
!                      A000164 = DERIVATIVE OF A000162 W.R.T. ETA(002)
      A000164=A000161*A000162 
!                      A000165 = DERIVATIVE OF A000163 W.R.T. ETA(002)
      A000165=-A000164 
      ELSE 
      ENDIF 
!                      A000167 = DERIVATIVE OF A000166 W.R.T. ETA(002)
      A000167=Q000020*A000165 
!                      A000173 = DERIVATIVE OF A000171 W.R.T. ETA(002)
      A000173=A000170*A000171 
!                      A000179 = DERIVATIVE OF A000175 W.R.T. ETA(002)
      A000179=A000166*A000171 
!                      A000180 = DERIVATIVE OF A000175 W.R.T. ETA(002)
      A000180=YR11*A000167+A000179 
!                      A000181 = DERIVATIVE OF A000176 W.R.T. ETA(002)
      A000181=A000171*A000166 
!                      A000182 = DERIVATIVE OF A000176 W.R.T. ETA(002)
      A000182=YR10*A000173+A000181 
!                      A000183 = DERIVATIVE OF A000176 W.R.T. ETA(002)
      A000183=A000180+A000182 
!                      A000190 = DERIVATIVE OF A000188 W.R.T. ETA(002)
      A000190=B000110*A000159 
!                      A000191 = DERIVATIVE OF A000189 W.R.T. ETA(002)
      A000191=QUIT*A000183 
!                      A000192 = DERIVATIVE OF A000189 W.R.T. ETA(002)
      A000192=A000190+A000191 
      IF(MDV == 0.D0)THEN 
!                      A000197 = DERIVATIVE OF A000193 W.R.T. ETA(002)
      A000197=A000144*A000189 
!                      A000198 = DERIVATIVE OF A000193 W.R.T. ETA(001)
      A000198=YR*A000153 
!                      A000199 = DERIVATIVE OF A000194 W.R.T. ETA(002)
      A000199=YP*A000192 
      ELSE 
      ENDIF 
!                      A000206 = DERIVATIVE OF A000204 W.R.T. ETA(002)
      A000206=Q000022*A000199 
!                      A000207 = DERIVATIVE OF A000205 W.R.T. ETA(001)
      A000207=Q000022*A000198 
!                      A000208 = DERIVATIVE OF A000205 W.R.T. ETA(002)
      A000208=Q000022*A000197 
!                      A000211 = DERIVATIVE OF A000209 W.R.T. ETA(002)
      A000211=A000208 
!                      A000212 = DERIVATIVE OF A000209 W.R.T. ETA(001)
      A000212=A000207 
!                      A000213 = DERIVATIVE OF A000210 W.R.T. ETA(002)
      A000213=A000206 
!                      A000212 = 2ND DERIV OF F W.R.T. ETA(001), ETA(001)
      G(001,002)=A000212
!                      A000211 = 2ND DERIV OF F W.R.T. ETA(002), ETA(001)
      G(002,002)=A000211
!                      A000213 = 2ND DERIV OF F W.R.T. ETA(002), ETA(002)
      G(002,003)=A000213
      ENDIF
      F=Y
      RETURN
      END
      SUBROUTINE FSIZESR(NAME_FSIZES,F_SIZES)
      USE SIZES, ONLY: ISIZE
      INTEGER(KIND=ISIZE), DIMENSION(*) :: F_SIZES
      CHARACTER(LEN=*),    DIMENSION(*) :: NAME_FSIZES
      NAME_FSIZES(01)='LTH'; F_SIZES(01)=15
      NAME_FSIZES(02)='LVR'; F_SIZES(02)=3
      NAME_FSIZES(03)='LVR2'; F_SIZES(03)=2
      NAME_FSIZES(04)='LPAR'; F_SIZES(04)=19
      NAME_FSIZES(05)='LPAR3'; F_SIZES(05)=0
      NAME_FSIZES(06)='NO'; F_SIZES(06)=0
      NAME_FSIZES(07)='MMX'; F_SIZES(07)=1
      NAME_FSIZES(08)='LNP4'; F_SIZES(08)=0
      NAME_FSIZES(09)='LSUPP'; F_SIZES(09)=1
      NAME_FSIZES(10)='LIM7'; F_SIZES(10)=0
      NAME_FSIZES(11)='LWS3'; F_SIZES(11)=0
      NAME_FSIZES(12)='MAXIDS'; F_SIZES(12)=600
      NAME_FSIZES(13)='LIM1'; F_SIZES(13)=0
      NAME_FSIZES(14)='LIM2'; F_SIZES(14)=0
      NAME_FSIZES(15)='LIM3'; F_SIZES(15)=0
      NAME_FSIZES(16)='LIM4'; F_SIZES(16)=0
      NAME_FSIZES(17)='LIM5'; F_SIZES(17)=0
      NAME_FSIZES(18)='LIM6'; F_SIZES(18)=0
      NAME_FSIZES(19)='LIM8'; F_SIZES(19)=0
      NAME_FSIZES(20)='LIM10'; F_SIZES(20)=0
      NAME_FSIZES(21)='LIM11'; F_SIZES(21)=0
      NAME_FSIZES(22)='LIM13'; F_SIZES(22)=0
      NAME_FSIZES(23)='LIM15'; F_SIZES(23)=0
      NAME_FSIZES(24)='LIM16'; F_SIZES(24)=0
      NAME_FSIZES(25)='MAXRECID'; F_SIZES(25)=0
      NAME_FSIZES(26)='PC'; F_SIZES(26)=0
      NAME_FSIZES(27)='PCT'; F_SIZES(27)=1
      NAME_FSIZES(28)='PIR'; F_SIZES(28)=1
      NAME_FSIZES(29)='PD'; F_SIZES(29)=15
      NAME_FSIZES(30)='PAL'; F_SIZES(30)=0
      NAME_FSIZES(31)='MAXFCN'; F_SIZES(31)=0
      NAME_FSIZES(32)='MAXIC'; F_SIZES(32)=0
      NAME_FSIZES(33)='PG'; F_SIZES(33)=0
      NAME_FSIZES(34)='NPOPMIXMAX'; F_SIZES(34)=0
      NAME_FSIZES(35)='MAXOMEG'; F_SIZES(35)=2
      NAME_FSIZES(36)='MAXPTHETA'; F_SIZES(36)=16
      NAME_FSIZES(37)='MAXITER'; F_SIZES(37)=20
      NAME_FSIZES(38)='ISAMPLEMAX'; F_SIZES(38)=0
      NAME_FSIZES(39)='DIMTMP'; F_SIZES(39)=0
      NAME_FSIZES(40)='DIMCNS'; F_SIZES(40)=0
      NAME_FSIZES(41)='DIMNEW'; F_SIZES(41)=0
      NAME_FSIZES(42)='PDT'; F_SIZES(42)=21
      NAME_FSIZES(43)='LADD_MAX'; F_SIZES(43)=0
      NAME_FSIZES(44)='MAXSIDL'; F_SIZES(44)=0
      NAME_FSIZES(45)='NTT'; F_SIZES(45)=15
      NAME_FSIZES(46)='NOMEG'; F_SIZES(46)=2
      NAME_FSIZES(47)='NSIGM'; F_SIZES(47)=0
      NAME_FSIZES(48)='PPDT'; F_SIZES(48)=14
      RETURN
      END SUBROUTINE FSIZESR
      SUBROUTINE MUMODEL2(THETA,MU_,ICALL,IDEF,NEWIND,&
      EVTREC,DATREC,IREV,NVNT,INDXS,F,G,H,IRGG,GG,NETAS)
      USE NMPRD4P
      USE SIZES,     ONLY: DPSIZE,ISIZE
      USE PRDIMS,    ONLY: GPRD,HPRD,GERD,HERD,GPKD
      USE NMPRD_REAL,ONLY: ETA,EPS
      USE NMPRD_INT, ONLY: MSEC=>ISECDER,MFIRST=>IFRSTDER,IFIRSTEM
      USE NMPRD_INT, ONLY: MDVRES,ETASXI,NPDE_MODE,NOFIRSTDERCODE
      USE NMPRD_REAL, ONLY: DV_LOQ,CDF_L
      USE NMBAYES_REAL, ONLY: LDF
      IMPLICIT REAL(KIND=DPSIZE) (A-Z)
      REAL(KIND=DPSIZE)   :: MU_(*)
      REAL(KIND=DPSIZE) :: DATREC
      SAVE
      INTEGER(KIND=ISIZE) :: ICALL,NEWIND,INDXS
      REAL(KIND=DPSIZE) :: G(GPRD,*),H(HPRD,*)
      DIMENSION :: THETA(*),DATREC(*),INDXS(*)
      RETURN
      END
